[Английский/English](README.md)

## Описание

Рутокен Технологии — приложение для демонстрации возможностей устройств линейки Рутокен ЭЦП на мобильных устройствах с
Android 7 и новее.

Приложение содержит два раздела:

* Удостоверяющий центр — для демонстрации возможностей тестового удостоверяющего центра. В этом разделе можно
  сгенерировать ключевую пару и выпустить тестовый сертификат на мобильном устройстве. Созданные объекты можно
  использовать в разделе Банк.
* Банк — для демонстрации сценариев работы с устройствами Рутокен в банковских приложениях. В этом разделе можно
  подписать тестовый платежный документ, проверить действительность электронной подписи входящих документов, зашифровать
  и расшифровать банковский документ.

Проект состоит из двух Gradle модулей:

* `module.rutoken-tech` — главный модуль, содержащий всю бизнес-логику и UI приложения;
* `test.use-cases-tests` — модуль инструментальных тестов, в которых проверяется корректность выполнения различных
  операций с токеном.

# Требования

Приложение "Рутокен Технологии" собирается с использованием Android SDK Platform 34 и новее и запускается на устройствах
с Android 7 (API level 24) и новее.

Для сборки приложения требуются внешние зависимости, которые можно найти
в [Рутокен SDK](https://www.rutoken.ru/developers/sdk/). Необходимые библиотеки:

* librtpkcs11ecp.so под архитектуры: `armeabi-v7a` и `arm64-v8a`.

# Предварительные действия

Для работы в разделе Банк на устройстве линейки Рутокен ЭЦП необходимо иметь ключевую пару и сертификат. Если их нет, то
для тестовых целей создать их можно в разделе Удостоверяющий центр мобильного приложения. Или на настольном компьютере
выполнить следующие действия:

1. Загрузите и установите [Рутокен Плагин](https://www.rutoken.ru/products/all/rutoken-plugin/) на компьютер.
2. Перезагрузите браузер для завершения установки плагина.
3. Через браузер зайдите на веб-сайт [Центр регистрации Рутокен](https://ra.rutoken.ru/).
4. Подключите устройство линейки Рутокен ЭЦП к компьютеру.
5. Убедитесь, что веб-сайт обнаружил устройство.
6. Создайте ключевую пару ГОСТ Р 34.10-2012 256 бит и сертификат, следуя инструкциям на веб-сайте.
7. Убедитесь, что веб-сайт обнаружил ключевую пару и сертификат на устройстве.
8. Отключите устройство Рутокен от компьютера и используйте его вместе с устройством Android.

## Как собрать

1. Перед сборкой проекта скопируйте скачанные внешние зависимости в
   директорию `module.rutoken-tech/src/main/jniLibs/<arch>`, где `<arch>` — архитектура библиотеки. Пример расположения
   файлов и директорий показан ниже:

    ```Text
    module.rutoken-tech
    | - src
    |   | - main
    |   |   | - jniLibs
    |   |   |   | - arm64-v8a
    |   |   |   |   | - librtpkcs11ecp.so
    |   |   |   | - armeabi-v7a
    |   |   |   |   | - librtpkcs11ecp.so
    ```

2. Собрать проект можно следующими способами:

    * С помощью Gradle из командной строки. В этом случае в командной строке необходимо выполнить команду:

   ```shell
   ./gradlew :module.rutoken-tech:assemble
   ```

   После чего apk-файлы приложения можно будет найти в
   директории `module.rutoken-tech/build/outputs/apk/<build_variant>`, где `<build_variant>` — вариант сборки (debug или
   release).

    * С помощью Android Studio. С инструкцией по сборке можно ознакомиться в
      статье [Build and run your app](https://developer.android.com/studio/run) в документации к Android от Google.

# Ограничения

Приложение "Рутокен Технологии" может быть запущено только на физических устройствах, не на эмуляторе.

# Лицензия

Программный код проекта распространяется по [BSD-2-Clause License](LICENSE_RUS).
